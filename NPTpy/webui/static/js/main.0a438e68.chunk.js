(window["webpackJsonpreact-app"]=window["webpackJsonpreact-app"]||[]).push([[0],{42:function(e,t,n){e.exports=n(78)},50:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);n(43),n(44),n(45);var r=n(0),a=n.n(r),o=n(17),l=n.n(o),i=n(10),c=n(12),s=n(13),u=n(15),v=n(14),d=n(19),m=n(16),p=(n(50),n(11)),f=n(8),w=n(21),b=n.n(w),h="/api";function g(e){return e.then(function(e){return e.data?e.data:Promise.reject("No reply from server")}).catch(function(e){if(!e.response||400!==e.response.status)throw e;f.b.warning(e.message),console.log(e.response.data)})}function y(e,t){return g(b.a.post(h+e,t))}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach(function(t){Object(p.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var O=200,D=1e3;function j(){window.clearInterval(window.intervalID),window.intervalID=0}function C(e){window.document.hidden||window.isOK===e&&window.intervalID||(window.isOK=e,j(),window.intervalID=window.setInterval(window.refreshStore,e?O:D))}function S(e){return e.then(window.updateStore).catch(function(e){window.rootComponent.setState(E({},window.rootComponent.state,{isLive:!1})),C(!1),f.b.error("",{toastId:1}),f.b.update(1,{render:e.message,autoClose:!1})})}window.bootID=void 0,window.portalTime=void 0,window.intervalID=0,window.isOK=!1,window.document.addEventListener("visibilitychange",function(){window.document.hidden?j():window.refreshStore()}),window.updateStore=function(e){if(e){if(window.bootID||(window.bootID=e.bootID),e.bootID!==window.bootID)throw Error("Out of sync, please refresh the page");window.portalTime=e.time,window.rootComponent.setState(E({},window.rootComponent.state,{isLive:!0,store:e.store})),C(!0),f.b.dismiss(1)}},window.refreshStore=function(){return S((e="/",g(b.a.post(h+e,{}))));var e},window.postStoreDelta=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!e||!!t;window.rootComponent.setState(E({},window.rootComponent.state,{saved:n}));var r={bootID:window.bootID,time:window.portalTime,store:e,save:t};return S(y("/",r))},window.saveChanges=function(){return window.postStoreDelta({},!0)};var I=n(9),N=(n(72),n(73),function(e){var t=e.isLive,n=e.saved,r=e.portalID,o=e.toggleLevel,l=e.onToggle;return a.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},a.a.createElement("i",{className:"fa clickable toggler L"+o,onClick:l}),a.a.createElement("a",{href:"/",className:"navbar-brand"},"NetPort"),a.a.createElement("div",{className:"collapse navbar-collapse"},a.a.createElement("div",{className:"navbar-nav"},a.a.createElement("span",{className:"nav-item nav-link"},"Portal [",r,"]"))),a.a.createElement("button",{className:"btn btn-success mx-3",disabled:n,onClick:window.saveChanges},"Save"),a.a.createElement("span",{className:"navbar-brand text-"+(t?"success":"warning")},a.a.createElement("i",{className:"mx-2 fa fa-"+(t?"check":"exclamation")}),t?"Live":"Offline"))});n(74);function P(e){return function(e){return e instanceof Array&&(!e.length||void 0!==e[0].k)}(e)?e:Object.keys(e).map(function(t){return{k:t,v:e[t]}})}var L=["collapse","toggled","","toggled"];function A(e){return e.map(function(e){return{k:e.v.otherID,v:e.v.otherID}})}function x(e,t){return t.length?t.map(function(t){var n=t.k,r=t.v;return a.a.createElement(i.c,{exact:!0,key:n,to:"/".concat(e,"/").concat(n)},r)}):a.a.createElement("span",{className:"disabled"},"No entries")}var T=function(e){var t=P(e.links),n=A(t.filter(function(e){return e.v.isClient})),r=A(t.filter(function(e){return!e.v.isClient}));return a.a.createElement(I.e.Consumer,null,function(t){return a.a.createElement("ul",{className:"sidebar navbar-nav "+L[e.toggleLevel]},a.a.createElement("li",null,a.a.createElement(i.c,{exact:!0,to:"/"},a.a.createElement("i",{className:"fa fa-home"}),"Home")),a.a.createElement("li",null,a.a.createElement(i.c,{to:"/links",className:"drops"},a.a.createElement("i",{className:"fa fa-plug"}),"Links"),a.a.createElement("div",{className:window.isLocationActive("/links")?"":"collapse"},a.a.createElement("span",null,"Permanent"),x("links",n),a.a.createElement("hr",null),a.a.createElement("span",null,"Temporary"),x("links",r))))})},R=function(e){function t(){var e;Object(c.a)(this,t),(e=Object(u.a)(this,Object(v.a)(t).call(this))).state={toggleLevel:2},e.toggle=function(){var t=e.state;t.toggleLevel+=2,t.toggleLevel>3&&(t.toggleLevel=0),localStorage.toggleLevel=t.toggleLevel,e.setState(t)};var n=localStorage.toggleLevel;return n&&(e.state.toggleLevel=parseInt(n)),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isLive,n=e.store,r=e.saved,o=e.children,l=this.state.toggleLevel;return a.a.createElement(a.a.Fragment,null,a.a.createElement(f.a,{autoClose:5e3,position:"top-center"}),a.a.createElement(N,{isLive:t,saved:r,portalID:n.portalID,toggleLevel:l,onToggle:this.toggle}),a.a.createElement("div",{className:"wrapper"},a.a.createElement(T,{links:n.links,toggleLevel:l}),a.a.createElement("main",{className:"container-fluid overflow-auto p-4"},o)))}}]),t}(r.Component);function B(e){return a.a.createElement("i",{className:"fa fa-"+(e?"check":"times")})}var F=n(40),H=n.n(F);function J(e,t){var n=[],r=[],o=!0,l=!1,i=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,v=1,d=1;u.v.subColumns?(d=u.v.leafCount,r=r.concat(u.v.subColumns)):v=e,n.push(a.a.createElement("th",{key:u.k,rowSpan:v,colSpan:d},u.v.label))}}catch(m){l=!0,i=m}finally{try{o||null==s.return||s.return()}finally{if(l)throw i}}return{cells:n,queue:r}}var K=function(e){for(var t=e.columns,n=[],r=function e(t){var n=0,r=0,a=!0,o=!1,l=void 0;try{for(var i,c=t[Symbol.iterator]();!(a=(i=c.next()).done);a=!0){var s=i.value;if(s.v.subColumns){var u=e(s.v.subColumns),v=u.height,d=u.leafCount;s.v.leafCount=d,v>n&&(n=v),r+=d}else r+=1}}catch(m){o=!0,l=m}finally{try{a||null==c.return||c.return()}finally{if(o)throw l}}return{height:n+1,leafCount:r}}(t).height;r>0;r--){var o=J(r,t),l=o.cells,i=o.queue;n.push(a.a.createElement("tr",{key:r},l)),t=i}return a.a.createElement("thead",null,n)};function q(e){var t=e.k,n=(e.v,e.cells);return a.a.createElement("tr",{key:window.JSON.stringify(t)},n)}var U=function(e){var t=e.columns,n=e.data,r=e.rowRenderer;return r=r||q,a.a.createElement("tbody",null,n.length?n.map(function(e){var n=e.k,o=e.v;return r({k:n,v:o,cells:t.map(function(e){return a.a.createElement("td",{key:e.k},e.v.renderer({k:n,v:o}))})})}):a.a.createElement("tr",null,a.a.createElement("td",{colSpan:t.length},"No entries")))};var _=function(e){var t=P(e.columns),n=P(e.data),r=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[],a=!0,o=!1,l=void 0;try{for(var i,c=t[Symbol.iterator]();!(a=(i=c.next()).done);a=!0){var s=i.value;if(s.v._keyIsAbs||(s.v._keyIsAbs=!0,s.k=n+s.k),s.v.subColumns){s.v.subColumns=P(s.v.subColumns);var u=e(s.v.subColumns,s.k+"."),v=!0,d=!1,m=void 0;try{for(var p,f=u[Symbol.iterator]();!(v=(p=f.next()).done);v=!0){var w=p.value;r.push(w)}}catch(b){d=!0,m=b}finally{try{v||null==f.return||f.return()}finally{if(d)throw m}}}else r.push(s)}}catch(b){o=!0,l=b}finally{try{a||null==c.return||c.return()}finally{if(o)throw l}}return r}(t);return function(e){e.forEach(function(e){var t=e.v;t.renderer||(t.renderer=function(e){return H.a.get(e,t.path)})})}(r),a.a.createElement("table",{className:"table table-bordered "+e.className},a.a.createElement(K,{columns:t}),a.a.createElement(U,{columns:r,data:n,rowRenderer:e.rowRenderer}))};var W={myID:{path:"k"},otherID:{label:"Remote portal ID",path:"v.otherID",renderer:function(e){var t=e.v;return a.a.createElement("a",{href:"/links/".concat(t.otherID)},t.otherID)}},rt:{label:"Use for relay",subColumns:{addr:{label:"Address",path:"v.rtAddr"},port:{label:"Port",path:"v.rtPort"}}},lt:{label:"Use for local",subColumns:{addr:{label:"Address",path:"v.ltAddr"},port:{label:"Port",path:"v.ltPort"}}},listeners:{label:"Listeners",path:"v.listeners.length"},eps:{label:"Endpoints",path:"v.eps.length"},state:{label:"Current state",path:"v.state"},waitingSince:{label:"Waiting for (seconds)",path:"v.waitingSince",renderer:function(e){var t=e.v;return t.waitingSince?(window.portalTime-t.waitingSince).toFixed(3):"N/A"}},allowSelect:{label:"Allow select()",path:"v.allowSelect",renderer:function(e){return B(e.v.allowSelect)}},buffer:{label:"Buffer",path:"v.buffer",renderer:function(){return"Buffer"}},delete:{renderer:function(e){var t=e.k;return a.a.createElement("button",{onClick:function(){return e=t,void window.postStoreDelta({links:[{k:e,v:null}]});var e},className:"btn btn-danger btn-sm"},"Delete")}}},z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(a)))).state={selectedType:"all"},n.selectType=function(e){n.setState({selectedType:e})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.selectedType,t=this.props.links||[],n="all"===e?t:t.filter(function(t){return t.v.isClient===("perm"===e)});return a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col"},a.a.createElement("p",null,"Showing ",n.length," out of ",t.length," total links."),a.a.createElement(_,{columns:W,data:n})))}}]),t}(r.Component),G=n(41);var M=function(e){var t=e.className,n=Object(G.a)(e,["className"]);return a.a.createElement("button",Object.assign({className:"btn btn-danger btn-sm "+t},n),"Delete")};function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var V={myID:{path:"k"},remote:{label:"Remote",subColumns:{addr:{label:"Address",path:"v.remoteAddr"},port:{label:"Port",path:"v.remotePort"}}},listening:{label:"Listening",subColumns:{addr:{label:"Address",path:"v.localAddr",renderer:function(e){var t=e.v;return"0.0.0.0"===t.localAddr||"::"===t.localAddr?a.a.createElement("b",null,"Any"):t.localAddr}},port:{label:"Port",path:"v.localPort"}}},allowSelect:{label:"Allow select()",path:"v.allowSelect",renderer:function(e){return B(e.v.allowSelect)}},reserveID:{label:"Reserved channel ID",path:"v.reserveID",renderer:function(e){return e.v.reserveID}}};var X=function(e){var t=e.link,n=e.listeners,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(n,!0).forEach(function(t){Object(p.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},V,{delete:{renderer:function(e){var n=e.k;return a.a.createElement(M,{onClick:function(){return e=t.k,r=n,void window.postStoreDelta({links:[{k:e,v:{listeners:[{k:r,v:null}]}}]});var e,r}})}}});return a.a.createElement(_,{columns:r,data:n,sortColumn:{key:"listening.port",ascending:!0}})};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Z={myID:{label:"Local ID",path:"k"},myIDF:{label:"Foreign ID",path:"v.myIDF"},allowSelect:{label:"Allow select()",path:"v.allowSelect",renderer:function(e){return B(e.v.allowSelect)}}};var $=function(e){var t=e.link,n=e.eps,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(n,!0).forEach(function(t){Object(p.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},Z,{delete:{renderer:function(e){var n=e.k;return 0===n?null:a.a.createElement(M,{onClick:function(){return e=t.k,r=n,void window.postStoreDelta({links:[{k:e,v:{eps:[{k:r,v:null}]}}]});var e,r}})}}});return a.a.createElement(_,{columns:r,data:n})};var ee=function(e){var t=e.links,n=e.id;if(!t||!n)return null;var r,o=t.find(function(e){return e.v.otherID===n});if(!o)return r="No link to portal "+n,f.b.error(r),window.routerComponent.history.goBack(),null;var l=o.v,i=l.listeners,c=l.eps;return a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col"},a.a.createElement("h4",{className:"text-center"},"Showing link to portal ",n),a.a.createElement("h5",null,"Has ",i.length," listener",1===i.length?"":"s"),a.a.createElement("div",{className:"ml-4"},a.a.createElement(X,{link:o,listeners:i})),a.a.createElement("h5",null,"Has ",c.length," endpoint",1===c.length?"":"s"),a.a.createElement("div",{className:"ml-4"},a.a.createElement($,{link:o,eps:c}))))},te=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(v.a)(t).call(this))).state={isLive:!1,store:{links:[]},saved:!0},window.rootComponent=Object(d.a)(e),window.refreshStore(),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.isLive,n=e.store,r=e.saved;return a.a.createElement(R,{isLive:t,store:n,saved:r},a.a.createElement(I.d,null,a.a.createElement(I.b,{exact:!0,path:"/",render:function(e){return a.a.createElement("h6",null,"TODO")}}),a.a.createElement(I.b,{exact:!0,path:"/links",render:function(e){return a.a.createElement(z,{links:n.links})}}),a.a.createElement(I.b,{exact:!0,path:"/links/:id",render:function(e){return a.a.createElement(ee,{links:n.links,id:e.match.params.id})}}),a.a.createElement(I.a,{to:"/"})))}}]),t}(r.Component);window.routerComponent={history:{location:{},goBack:function(){}}},window.linkInterceptor=new i.b({}),window.interceptClick=function(e){"a"===e.target.tagName.toLowerCase()&&(window.linkInterceptor.props.to=e.target.pathname,window.linkInterceptor.handleClick(e,window.routerComponent.history))},window.document.addEventListener("click",window.interceptClick),window.isLocationActive=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(i.c)({to:e,exact:t}),r=n.props.children(window.routerComponent.history);return"active"===r.props.className},window.routerComponent=l.a.render(a.a.createElement(i.a,null,a.a.createElement(te,null)),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.0a438e68.chunk.js.map